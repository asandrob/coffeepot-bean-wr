<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Coffeepot-bean-wr by jean-merelis</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Coffeepot-bean-wr</h1>
      <h2 class="project-tagline">Writer and Reader for flat files</h2>
      <a href="https://github.com/jean-merelis/coffeepot-bean-wr" class="btn">View on GitHub</a>
      <a href="https://github.com/jean-merelis/coffeepot-bean-wr/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/jean-merelis/coffeepot-bean-wr/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="coffeepot-bean-wr-writer-and-reader" class="anchor" href="#coffeepot-bean-wr-writer-and-reader" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>coffeepot-bean-wr (Writer and Reader)</h1>

<p>Coffeepot-bean-wr is a simple Java framework for marshalling Java beans to flat file and unmarshal flat file to Java Beans.</p>

<p>Features:</p>

<ul>
<li>Support for delimited and fixed length formats.</li>
<li>Uses Java annotations for mapping.</li>
<li>Maps unannotated classes dynamically.</li>
<li>Override annotations dynamically.</li>
<li>Custom type handlers are supported.</li>
</ul>

<p>Real examples of use you will find them in <a href="https://github.com/jean-merelis/coffeepot-br-sped-fiscal">coffeepot-br-sped-fiscal</a> and <a href="https://github.com/jean-merelis/coffeepot-br-sintegra">coffeepot-br-sintegra</a> projects. The coffeepot-br-sped-fiscal project uses delimited format, and the sintegra project uses FixedLength format.</p>

<p>Download from Maven central</p>

<div class="highlight highlight-text-xml"><pre>        &lt;<span class="pl-ent">dependency</span>&gt;
            &lt;<span class="pl-ent">groupId</span>&gt;com.github.jean-merelis&lt;/<span class="pl-ent">groupId</span>&gt;
            &lt;<span class="pl-ent">artifactId</span>&gt;coffeepot-bean-wr&lt;/<span class="pl-ent">artifactId</span>&gt;
            &lt;<span class="pl-ent">version</span>&gt;1.2.2-FINAL&lt;/<span class="pl-ent">version</span>&gt;            
        &lt;/<span class="pl-ent">dependency</span>&gt; </pre></div>

<h2>
<a id="examples" class="anchor" href="#examples" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Examples</h2>

<h2>
<a id="mapping" class="anchor" href="#mapping" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Mapping</h2>

<div class="highlight highlight-source-java"><pre>        @Record(fields <span class="pl-k">=</span> {
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, id <span class="pl-k">=</span> <span class="pl-c1">true</span>, constantValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ORDER<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>id<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>date<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>customer<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>items<span class="pl-pds">"</span></span>)
            })
        <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Order</span> {

            <span class="pl-k">private</span> <span class="pl-smi">Integer</span> id;
            <span class="pl-k">private</span> <span class="pl-smi">Date</span> date;
            <span class="pl-k">private</span> <span class="pl-smi">String</span> customer;
            <span class="pl-k">private</span> <span class="pl-k">List&lt;<span class="pl-smi">Item</span>&gt;</span> items;

            <span class="pl-c">// getters and setters...</span>
        }

        @Record(fields <span class="pl-k">=</span> {
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, id <span class="pl-k">=</span> <span class="pl-c1">true</span>, constantValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>ITEM<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>number<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>product<span class="pl-pds">"</span></span>),
                @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>quantity<span class="pl-pds">"</span></span>)
            })
        <span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Item</span> {

            <span class="pl-k">private</span> <span class="pl-k">int</span> number;
            <span class="pl-k">private</span> <span class="pl-smi">String</span> product;
            <span class="pl-k">private</span> <span class="pl-k">double</span> quantity;

            <span class="pl-c">// getters ... setters...</span>
        }       </pre></div>

<p>Using...</p>

<div class="highlight highlight-source-java"><pre>
    <span class="pl-k">public</span> <span class="pl-k">void</span> test() throws <span class="pl-smi">Exception</span>{
        <span class="pl-smi">Order</span> order <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">Order</span>();
        <span class="pl-c">//add some data</span>

        <span class="pl-smi">File</span> file <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">File</span>(<span class="pl-s"><span class="pl-pds">"</span>ORDER.tmp<span class="pl-pds">"</span></span>);
        <span class="pl-smi">Writer</span> w <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">FileWriter</span>(file);

        <span class="pl-smi">DelimitedWriter</span> instance <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">DelimitedWriter</span>(w);
        instance<span class="pl-k">.</span>setDelimiter(<span class="pl-s"><span class="pl-pds">'</span>|<span class="pl-pds">'</span></span>);
        instance<span class="pl-k">.</span>setEscape(<span class="pl-s"><span class="pl-pds">'</span><span class="pl-cce">\\</span><span class="pl-pds">'</span></span>);
        instance<span class="pl-k">.</span>setRecordTerminator(<span class="pl-s"><span class="pl-pds">"</span>|<span class="pl-cce">\r\n</span><span class="pl-pds">"</span></span>);

        instance<span class="pl-k">.</span>write(order);

        w<span class="pl-k">.</span>flush();
        w<span class="pl-k">.</span>close();
</pre></div>

<p>Output: </p>

<pre><code>    ORDER|123|2015-03-10T00:04:15|john b|
    ITEM|1|product 1|10|
    ITEM|2|product 2|5|
    ITEM|3|product 3|2|
</code></pre>

<h2>
<a id="reading" class="anchor" href="#reading" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Reading</h2>

<p>For simple file structure, i.e. where the file has only one type of record, simply map the fields of the class that represents this record and perform the reading. </p>

<p>If file contains a list of these records you can read with the parseAsListOf.</p>

<div class="highlight highlight-source-java"><pre>    <span class="pl-c">//Example for a file with a list of the records.</span>

    <span class="pl-k">public</span> <span class="pl-k">void</span> read(){
        <span class="pl-smi">File</span> file <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">File</span>(<span class="pl-s"><span class="pl-pds">"</span>file-with-a-list-of-records.txt<span class="pl-pds">"</span></span>);

        <span class="pl-k">try</span> (<span class="pl-smi">FileReader</span> fr <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">FileReader</span>(file)) {
            <span class="pl-smi">FixedLengthReader</span> reader <span class="pl-k">=</span> <span class="pl-k">new</span> <span class="pl-smi">FixedLengthReader</span>(fr);
            <span class="pl-k">List&lt;<span class="pl-smi">MyRecord</span>&gt;</span> records <span class="pl-k">=</span> reader<span class="pl-k">.</span>parseAsListOf(<span class="pl-smi">MyRecord</span><span class="pl-k">.</span>class);
            <span class="pl-k">for</span> (<span class="pl-smi">MyRecord</span> r<span class="pl-k">:</span> records){ 
              <span class="pl-c1">...</span>
            }
        }

    }</pre></div>

<p>For more complex structures that have various types of records, it is necessary that the records have an identifier field so it can be possible to instantiate the corresponding class of the record.
The identifier field must have the value that identifies the record in the constantValue property and the id property must be true.</p>

<div class="highlight highlight-source-java"><pre>
@Record(fields <span class="pl-k">=</span> {
    @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, constantValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>01<span class="pl-pds">"</span></span>, id <span class="pl-k">=</span> <span class="pl-c1">true</span>, length <span class="pl-k">=</span> <span class="pl-c1">2</span>), <span class="pl-c">// identifier field</span>
    @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>, length <span class="pl-k">=</span> <span class="pl-c1">18</span>)
    <span class="pl-c">// ... more fields</span>
})

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">Rec01</span> {

    <span class="pl-k">private</span> <span class="pl-smi">String</span> value;

    <span class="pl-c">// more fields getters and setters...</span>
    <span class="pl-c1">...</span>
}


@Record(fields <span class="pl-k">=</span> {
    @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span><span class="pl-pds">"</span></span>, constantValue <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>AA<span class="pl-pds">"</span></span>, id <span class="pl-k">=</span> <span class="pl-c1">true</span>, length <span class="pl-k">=</span> <span class="pl-c1">2</span>), <span class="pl-c">// identifier field</span>
    @Field(name <span class="pl-k">=</span> <span class="pl-s"><span class="pl-pds">"</span>value<span class="pl-pds">"</span></span>, length <span class="pl-k">=</span> <span class="pl-c1">18</span>)
    <span class="pl-c">// ... more fields</span>
})

<span class="pl-k">public</span> <span class="pl-k">class</span> <span class="pl-en">RecAA</span> {

    <span class="pl-k">private</span> <span class="pl-smi">String</span> value;

    <span class="pl-c">// more fields getters and setters...</span>
    <span class="pl-c1">...</span>
}</pre></div>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/jean-merelis/coffeepot-bean-wr">Coffeepot-bean-wr</a> is maintained by <a href="https://github.com/jean-merelis">jean-merelis</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-63378958-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
